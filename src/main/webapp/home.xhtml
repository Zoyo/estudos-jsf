<f:view id="ajaxEcho" xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui">
    <h:head >
		<script src="http://maps.google.com/maps/api/js?sensor=true" 
				type="text/javascript">
		</script> 
	</h:head>
	<h:body>
		<h2>Testes gerais de JSF</h2>

		<h:form id="form1">
			<p:growl autoUpdate="true" life="3000" />
			
			<p:panelGrid id="gridGeral">
				<p:row>
					<p:column>
						<p:outputLabel for="inputLatitude">Latitude: </p:outputLabel>
					</p:column>
					<p:column>
						<p:inputText id="inputLatitude" required="true" value="#{myBean.latitude}" />
					</p:column>
				</p:row>
	    		
	    		<p:row>
					<p:column>
		            	<p:outputLabel for="inputLongitude">Longitude: </p:outputLabel>
					</p:column>
					<p:column>
		            	<p:inputText id="inputLongitude" required="true" value="#{myBean.longitude}" />
					</p:column>
	    		</p:row>        
	            
	            <p:row>
					<p:column>
		            	<p:commandButton action="#{myBean.adicionarMarcacao()}" value="Marcar" update="@form"/>
					</p:column>
					<p:column>
		            	<p:commandButton action="#{myBean.enderecoDeCasa()}" value="Minha Casa" update="@form"/>
					</p:column>
	            </p:row>
	            
	            <p:row>
					<p:column colspan="2">
			            <p:gmap center="-22.820492, -47.265501" 
			                    type="roadmap" 
			                    style="width:600px;height:400px"
			                    id="gmapa"
			                    model="#{myBean.simpleModel}"
			                    widgetVar="mapa">
			                    
								<p:ajax event="overlaySelect" listener="#{myBean.apagarMarcacao}" update="gmapa" />
								<p:ajax event="pointSelect" listener="#{myBean.capturarCoordenada}" update="gridGeral"/>
						</p:gmap>
					</p:column>	            
	            </p:row>
	            
	            <p:row>
	            	<p:column colspan="2">
	            		<p:commandButton action="#{myBean.limparMapa()}" value="Remover Marcações" update="gmapa"/>
	            	</p:column>
	            </p:row>
			</p:panelGrid>
			
			<p:contextMenu id="contextMenu">
				<p:menuitem value="Excluir"/>
				<p:menuitem value="Mostrar 10Km de Raio" />
			</p:contextMenu>			
		</h:form>
		
		<script type="text/javascript">
			var xPos = 0;
			var yPos = 0;
			jQuery(document).ready(function(){
			    $(document).mousemove(function(e){
			        xPos = e.pageX;
			        yPos = e.pageY;
			    }); 
			    
				var mapComponent = mapa.getMap();
				google.maps.event.addListener(mapComponent, 'right_click', function(mouseEvent) {
				    $(PrimeFaces.escapeClientId('form1:contextMenu')).css({
				        top: yPos+'px',
				        left: xPos+'px'                        
				    }).show();
				});		
			});
			
		</script>
	</h:body>
</f:view>